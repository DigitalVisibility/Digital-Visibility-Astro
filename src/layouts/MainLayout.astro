---
// Main layout component that will be used across all pages
const { title = "Digital Visibility - AI Powered Business Optimization", meta } = Astro.props;

// Use meta object if provided, otherwise fall back to individual props
const pageTitle = meta?.title || title;
const pageKeywords = meta?.keywords || "AI, digital marketing, app development, product design, business optimization";
const pageImage = meta?.image || "/digital-visibility-logo-f.png";
---

<!DOCTYPE html>
<html lang="en">
<!-- Cloudflare Early Hints Support -->
<!-- Early hints preloads -->
<!-- Early hints preconnect -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <!-- Cloudflare optimization hints -->
    <meta http-equiv="Cache-Control" content="public, max-age=86400">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="cf-2fa-verify" content="true">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T7HFBLX1X1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-T7HFBLX1X1');
    </script>



    <!-- Preload critical resources for better LCP -->
    <!-- Global CSS is now imported in the component frontmatter -->
    
    <!-- Preload critical scripts -->
    <link rel="preload" href="/scripts/lucide-icons.min.js" as="script">
    
    <!-- DNS prefetch and preconnect for external resources -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//imagedelivery.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://imagedelivery.net" crossorigin>
    <title>{pageTitle}</title>
    <!-- Removed global.css stylesheet reference -->
    <!-- Individual pages handle their own meta descriptions to avoid duplicates -->
    <meta name="keywords" content={pageKeywords}>
    
    <!-- Critical CSS inline for accessibility and contrast fixes -->
    <style>
      /* Fix text-gray-300 contrast issues - change to white for better contrast */
      .text-gray-300,
      span.text-gray-300,
      div.text-gray-300,
      p.text-gray-300,
      a.text-gray-300,
      li.text-gray-300,
      *[class*="text-gray-300"],
      [class*="text-gray-300"] *,
      .text-gray-300.text-sm,
      p.text-gray-300.text-sm {
        color: #ffffff !important;
      }
      
      /* Very specific targeting for the exact card text elements */
      p.text-gray-300.text-sm,
      .text-gray-300.text-sm,
      p[class*="text-gray-300"][class*="text-sm"] {
        color: #ffffff !important;
        font-weight: 400 !important;
      }
      
      /* ROI Calculator subtitle text */
      p.text-xl.text-gray-300,
      .text-xl.text-gray-300,
      p[class*="text-xl"][class*="text-gray-300"] {
        color: #ffffff !important;
      }
      
      /* Fix orange text contrast issues */
      .text-orange-600,
      a.text-orange-600,
      span.text-orange-600 {
        color: #c2410c !important;
      }
      
      /* Fix green button contrast issues - change to navy blue */
      .bg-green-600 {
        background-color: #1e3a8a !important; /* Navy blue background */
      }
      
      .bg-green-600.text-white,
      .bg-green-600 .text-white {
        color: #ffffff !important;
      }
      
      /* Override ALL green text with navy blue - maximum specificity */
      *[class*="text-green-600"],
      *[class*="text-green-500"],
      *[class*="text-green-700"],
      *[class*="text-green-800"],
      .text-green-600,
      span.text-green-600,
      .font-bold.text-green-600,
      span.font-bold.text-green-600,
      .text-green-500,
      .text-green-700,
      .text-green-800,
      span.text-green-500,
      span.text-green-700,
      span.text-green-800 {
        color: #1e3a8a !important; /* Navy blue text */
      }
      
      /* Ultra-specific override for pricing table */
      html body .bg-white span.font-bold.text-green-600,
      html body .bg-white .font-bold.text-green-600,
      html body .rounded-2xl span.font-bold.text-green-600,
      html body span[class*="text-green-600"],
      html body *[class*="font-bold"][class*="text-green-600"] {
        color: #1e3a8a !important; /* Navy blue text */
      }
      
      /* Nuclear option - override any green color */
      span:contains("£40/hour"),
      span:contains("£0"),
      span:contains("None Required"),
      span:contains("Worth £2,995") {
        color: #1e3a8a !important;
      }
      
      /* Tailwind override */
      .text-green-600 {
        --tw-text-opacity: 1;
        color: #1e3a8a !important;
      }
    </style>
    <!-- Favicon with multiple formats for better browser support -->
    <link rel="icon" type="image/png" sizes="32x32" href="/digital-visibility-logo-fav.png">
    <link rel="icon" type="image/webp" sizes="32x32" href="/digital-visibility-logo-fav.webp">
    <link rel="apple-touch-icon" href="/digital-visibility-logo-fav.png">
    
    <!-- Sitemap and Robots References -->
    <link rel="sitemap" type="application/xml" href="/sitemap.xml">
    
    <!-- Critical CSS for immediate rendering -->
    <style>
        /* Critical above-the-fold styles */
        *{box-sizing:border-box}
        body{margin:0;font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;color:#1f2937;line-height:1.5}
        .max-w-7xl{max-width:80rem;margin-left:auto;margin-right:auto}
        .mx-auto{margin-left:auto;margin-right:auto}
        .px-4{padding-left:1rem;padding-right:1rem}
        .py-12{padding-top:3rem;padding-bottom:3rem}
        .py-16{padding-top:4rem;padding-bottom:4rem}
        .py-24{padding-top:6rem;padding-bottom:6rem}
        .text-center{text-align:center}
        .font-bold{font-weight:700}
        .text-gray-900{color:#111827}
        .text-blue-600{color:#2563eb}
        .bg-white{background-color:#fff}
        .bg-gray-50{background-color:#f9fafb}
        .rounded-lg{border-radius:0.5rem}
        .shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,0.1),0 4px 6px -2px rgba(0,0,0,0.05)}
        .transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-duration:150ms}
        .hover\:bg-blue-700:hover{background-color:#1d4ed8}
        .inline-flex{display:inline-flex}
        .items-center{align-items:center}
        .justify-center{justify-content:center}
        .space-x-4>:not([hidden])~:not([hidden]){margin-left:1rem}
        .mb-4{margin-bottom:1rem}
        .mb-6{margin-bottom:1.5rem}
        .mt-6{margin-top:1.5rem}
        .text-xl{font-size:1.25rem;line-height:1.75rem}
        .text-2xl{font-size:1.5rem;line-height:2rem}
        .text-3xl{font-size:1.875rem;line-height:2.25rem}
        .text-4xl{font-size:2.25rem;line-height:2.5rem}
        .text-5xl{font-size:3rem;line-height:1}
        @media(min-width:768px){.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}.md\:text-5xl{font-size:3rem;line-height:1}.md\:py-24{padding-top:6rem;padding-bottom:6rem}.md\:flex-row{flex-direction:row}.md\:w-1\/2{width:50%}}
        @media(min-width:1024px){.lg\:px-8{padding-left:2rem;padding-right:2rem}}
        /* Navigation critical styles */
        nav{position:relative;z-index:50}
        .nav-container{max-width:80rem;margin:0 auto;padding:0 1rem}
        /* Button critical styles */
        .btn{display:inline-flex;align-items:center;justify-content:center;padding:0.75rem 1.5rem;border-radius:0.375rem;font-weight:500;transition:all 300ms;text-decoration:none;border:none;cursor:pointer}
        .btn-primary{background-color:#2563eb;color:#fff}
        .btn-primary:hover{background-color:#1d4ed8}
        .btn-secondary{background-color:#fff;color:#2563eb;border:1px solid #2563eb}
        .btn-secondary:hover{background-color:#eff6ff}
    </style>
    
    <!-- Schema markup removed from MainLayout to prevent conflicts with individual page schemas -->
    <slot name="head"/>
</head>
<body>
    <slot name="nav"/>
    
    <main>
        <slot />
    </main>

    <slot name="footer"/>

    <!-- Load scripts asynchronously to prevent render blocking -->
    <script>
        // Load Lucide icons asynchronously after initial render
        (function() {
            var script = document.createElement('script');
            script.src = '/scripts/lucide-icons.min.js';
            script.async = true;
            script.onload = function() {
                // Initialize icons after script loads
                if (typeof window.lucide !== 'undefined') {
                    window.lucide.createIcons();
                }
            };
            document.head.appendChild(script);
        })();
        
        // Optimize icon initialization to reduce LCP time
        document.addEventListener('DOMContentLoaded', function() {
            // Delay non-critical icon initialization
            setTimeout(function() {
                if (typeof window.lucide !== 'undefined') {
                    // Only process visible icons initially
                    var visibleIcons = document.querySelectorAll('[data-lucide]');
                    visibleIcons.forEach(function(icon) {
                        if (isInViewport(icon)) {
                            // Process immediately visible icons
                            window.lucide.createIcons();
                        } else {
                            // Lazy load icons that are not visible
                            icon.setAttribute('data-lazy-load', 'true');
                        }
                    });
                }
            }, 100);
        });
        
        // Helper function to check if element is in viewport
        function isInViewport(element) {
            var rect = element.getBoundingClientRect();
            return (
                rect.top >= 0 &&
                rect.left >= 0 &&
                rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                rect.right <= (window.innerWidth || document.documentElement.clientWidth)
            );
        }
    </script>
    <slot name="scripts"/>
</body>
</html>
